<!DOCTYPE html>
<html>

  <head>
    <title>DOD Connection Client</title>
  </head>

  <body>

    <p><span style="font-weight:bold">DOD says:</span></p>
    <div id="output"></div>

    <script>

      var host = "ws://raspberrypi:8080/ws";
      var socket = new WebSocket(host);

      if(socket) {
        socket.onopen = function() {

          document.onkeyup = function KeyCheck(event) {

            var KeyID = event.which; 

            switch(KeyID) {
              case 16:
                socket.send("robot|drivetrain|stop");
                socket.send("robot|drivetrain|coast");
                break;
              case 37:
                socket.send("robot|drivetrain|left");
                break;
              case 38:
                socket.send("robot|drivetrain|forward");
                break;
              case 39:
                socket.send("robot|drivetrain|right");
                break;
              case 40:
                socket.send("robot|drivetrain|reverse");
                break;
              case 68:
                socket.send("robot|forward_range|get");
                break;
              }
            }
          }

          socket.onmessage = function(msg) {
              showServerResponse(msg.data);
          }
          socket.onclose = function() {
              showServerResponse("Connection closed by server.");
          }
      } else {
          console.log("Invalid socket.");
      }

      function showServerResponse(txt) {
          var p = document.createElement('p');
          p.innerHTML = txt;
          document.getElementById('output').appendChild(p);
      }   

    </script>
  </body>
</html>

